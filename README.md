# MOPScraper

## 功能特點

- 自動爬取公司基本資訊（公司名稱、代號、產業類別）
- 爬取最新季度財務報表數據
- 支援批次處理多家公司
- 自動重試機制，提高穩定性
- 結果自動匯出為 Excel 檔案

## 系統需求

- Python 3.8 或以上版本
- Google Chrome 瀏覽器
- Windows/Mac/Linux 作業系統

## 安裝步驟

1. 下載程式碼到本地電腦

2. 安裝必要套件：
```bash
pip install -r requirements.txt
```

## 使用方法

1. 準備輸入檔案：
   - 在 `data/input` 目錄下放置 `company_list2.xlsx` 檔案
   - Excel 檔案格式說明：
     - 需包含「公司名稱」和「公司代號」兩個欄位

2. 執行程式：
```bash
python main.py
```

3. 查看結果：
   - 程式執行完成後，結果將自動儲存在 `data/output/results.xlsx`
   - 輸出檔案包含以下資訊：
     - 公司名稱
     - 公司代號
     - 產業類別
     - 年營收
     - 毛利額
     - 毛利率
     - 稅前淨利
     - 稅後淨利

## 注意事項

1. 執行程式前請確保：
   - 已安裝 Google Chrome 瀏覽器
   - 網路連線正常
   - 輸入的 Excel 檔案格式正確
   - 已在正確的目錄下執行程式

2. 程式執行過程中：
   - 會自動開啟 Chrome 瀏覽器，請勿手動關閉
   - 可以從終端機查看執行進度和錯誤訊息
   - 完整執行時間視公司數量而定，請耐心等待

3. 錯誤處理：
   - 程式內建自動重試機制，遇到網路問題會自動等待並重試
   - 如果持續失敗，請檢查網路連線或稍後再試

## 常見問題

1. Q: 程式無法執行？
   A: 請依序檢查：
   - 是否已安裝 Python 3.8 或以上版本
   - 是否已安裝所有必要套件
   - 是否已安裝 Chrome 瀏覽器
   - 是否在正確的目錄下執行程式

2. Q: 執行時出現錯誤訊息？
   A: 常見原因：
   - 網路連線不穩定：等待一段時間後重試
   - Excel 檔案格式錯誤：確認欄位名稱和格式是否正確
   - 公司代號錯誤：確認輸入的代號是否正確

3. Q: 有些公司沒有爬到資料？
   A: 可能原因：
   - 公司代號輸入錯誤
   - 該公司尚未公布最新財報
   - 網站暫時性問題
   - 該公司資料格式特殊

